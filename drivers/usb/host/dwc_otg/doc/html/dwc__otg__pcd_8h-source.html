<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver: dwc_otg_pcd.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>dwc_otg_pcd.h</h1><a href="dwc__otg__pcd_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/* ==========================================================================</span>
00002 <span class="comment"> * $File: //dwh/usb_iip/dev/software/otg/linux/drivers/dwc_otg_pcd.h $</span>
00003 <span class="comment"> * $Revision: #46 $</span>
00004 <span class="comment"> * $Date: 2011/10/20 $</span>
00005 <span class="comment"> * $Change: 1870124 $</span>
00006 <span class="comment"> *</span>
00007 <span class="comment"> * Synopsys HS OTG Linux Software Driver and documentation (hereinafter,</span>
00008 <span class="comment"> * "Software") is an Unsupported proprietary work of Synopsys, Inc. unless</span>
00009 <span class="comment"> * otherwise expressly agreed to in writing between Synopsys and you.</span>
00010 <span class="comment"> *</span>
00011 <span class="comment"> * The Software IS NOT an item of Licensed Software or Licensed Product under</span>
00012 <span class="comment"> * any End User Software License Agreement or Agreement for Licensed Product</span>
00013 <span class="comment"> * with Synopsys or any supplement thereto. You are permitted to use and</span>
00014 <span class="comment"> * redistribute this Software in source and binary forms, with or without</span>
00015 <span class="comment"> * modification, provided that redistributions of source code must retain this</span>
00016 <span class="comment"> * notice. You may not view, use, disclose, copy or distribute this file or</span>
00017 <span class="comment"> * any information contained herein except pursuant to this license grant from</span>
00018 <span class="comment"> * Synopsys. If you do not agree with this notice, including the disclaimer</span>
00019 <span class="comment"> * below, then you are not authorized to use the Software.</span>
00020 <span class="comment"> *</span>
00021 <span class="comment"> * THIS SOFTWARE IS BEING DISTRIBUTED BY SYNOPSYS SOLELY ON AN "AS IS" BASIS</span>
00022 <span class="comment"> * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
00023 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
00024 <span class="comment"> * ARE HEREBY DISCLAIMED. IN NO EVENT SHALL SYNOPSYS BE LIABLE FOR ANY DIRECT,</span>
00025 <span class="comment"> * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
00026 <span class="comment"> * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
00027 <span class="comment"> * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
00028 <span class="comment"> * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
00029 <span class="comment"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
00030 <span class="comment"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH</span>
00031 <span class="comment"> * DAMAGE.</span>
00032 <span class="comment"> * ========================================================================== */</span>
00033 <span class="preprocessor">#ifndef DWC_HOST_ONLY</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#if !defined(__DWC_PCD_H__)</span>
00035 <span class="preprocessor"></span><span class="preprocessor">#define __DWC_PCD_H__</span>
00036 <span class="preprocessor"></span>
00037 <span class="preprocessor">#include "<a class="code" href="dwc__otg__os__dep_8h.html">dwc_otg_os_dep.h</a>"</span>
00038 <span class="preprocessor">#include "usb.h"</span>
00039 <span class="preprocessor">#include "<a class="code" href="dwc__otg__cil_8h.html">dwc_otg_cil.h</a>"</span>
00040 <span class="preprocessor">#include "<a class="code" href="dwc__otg__pcd__if_8h.html">dwc_otg_pcd_if.h</a>"</span>
00041 <span class="keyword">struct </span>cfiobject;
00042 
<a name="l00059"></a><a class="code" href="dwc__otg__pcd_8h.html#a1">00059</a> <span class="preprocessor">#define DWC_DMA_ADDR_INVALID    (~(dwc_dma_t)0)</span>
00060 <span class="preprocessor"></span>
<a name="l00062"></a><a class="code" href="dwc__otg__pcd_8h.html#a2">00062</a> <span class="preprocessor">#define DDMA_MAX_TRANSFER_SIZE 65535</span>
00063 <span class="preprocessor"></span>
<a name="l00067"></a><a class="code" href="dwc__otg__pcd_8h.html#a3">00067</a> <span class="preprocessor">#define GET_CORE_IF( _pcd ) (_pcd-&gt;core_if)</span>
00068 <span class="preprocessor"></span>
<a name="l00072"></a><a class="code" href="dwc__otg__pcd_8h.html#a20">00072</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="dwc__otg__pcd_8h.html#a20">ep0_state</a> {
00073         EP0_DISCONNECT,         <span class="comment">/* no host */</span>
00074         EP0_IDLE,
00075         EP0_IN_DATA_PHASE,
00076         EP0_OUT_DATA_PHASE,
00077         EP0_IN_STATUS_PHASE,
00078         EP0_OUT_STATUS_PHASE,
00079         EP0_STALL,
00080 } ep0state_e;
00081 
00083 <span class="keyword">struct </span><a class="code" href="structdwc__otg__pcd.html">dwc_otg_pcd</a>;
00084 
<a name="l00088"></a><a class="code" href="dwc__otg__pcd_8h.html#a5">00088</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>usb_iso_request <a class="code" href="dwc__otg__pcd_8h.html#a5">dwc_otg_pcd_iso_request_t</a>;
00089 
00090 <span class="preprocessor">#ifdef DWC_UTE_PER_IO</span>
00091 <span class="preprocessor"></span>
00096 <span class="keyword">struct </span>dwc_iso_pkt_desc_port {
00097         uint32_t offset;
00098         uint32_t length;        <span class="comment">/* expected length */</span>
00099         uint32_t actual_length;
00100         uint32_t status;
00101 };
00102 
00103 <span class="keyword">struct </span>dwc_iso_xreq_port {
00105         uint32_t tr_sub_flags;
00107 <span class="preprocessor">#define DWC_EREQ_TF_ASAP                0x00000002</span>
00108 <span class="preprocessor"></span>
00109 <span class="preprocessor">#define DWC_EREQ_TF_ENQUEUE             0x00000004</span>
00110 <span class="preprocessor"></span>
00115         uint32_t pio_pkt_count;
00117         uint32_t pio_alloc_pkt_count;
00119         uint32_t error_count;
00121         uint32_t res;
00123         <span class="keyword">struct </span>dwc_iso_pkt_desc_port *per_io_frame_descs;
00124 };
00125 <span class="preprocessor">#endif</span>
00126 <span class="preprocessor"></span>
<a name="l00129"></a><a class="code" href="structdwc__otg__pcd__request.html">00129</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structdwc__otg__pcd__request.html">dwc_otg_pcd_request</a> {
00130         <span class="keywordtype">void</span> *priv;
00131         <span class="keywordtype">void</span> *buf;
00132         dwc_dma_t dma;
00133         uint32_t length;
00134         uint32_t actual;
00135         <span class="keywordtype">unsigned</span> sent_zlp:1;
<a name="l00140"></a><a class="code" href="structdwc__otg__pcd__request.html#o6">00140</a>      uint8_t *dw_align_buf;
00141      dwc_dma_t dw_align_buf_dma;
00142 
00143          DWC_CIRCLEQ_ENTRY(<a class="code" href="structdwc__otg__pcd__request.html">dwc_otg_pcd_request</a>) queue_entry;
00144 #ifdef DWC_UTE_PER_IO
00145         struct dwc_iso_xreq_port ext_req;
00146         <span class="comment">//void *priv_ereq_nport; /*  */</span>
00147 #endif
00148 } <a class="code" href="structdwc__otg__pcd__request.html">dwc_otg_pcd_request_t</a>;
00149 
00150 DWC_CIRCLEQ_HEAD(req_list, <a class="code" href="structdwc__otg__pcd__request.html">dwc_otg_pcd_request</a>);
00151 
<a name="l00156"></a><a class="code" href="structdwc__otg__pcd__ep.html">00156</a> typedef struct <a class="code" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep</a> {
<a name="l00158"></a><a class="code" href="structdwc__otg__pcd__ep.html#o0">00158</a>         <span class="keyword">const</span> usb_endpoint_descriptor_t *desc;
00159 
<a name="l00161"></a><a class="code" href="structdwc__otg__pcd__ep.html#o1">00161</a>         <span class="keyword">struct </span>req_list queue;
00162         <span class="keywordtype">unsigned</span> stopped:1;
00163         <span class="keywordtype">unsigned</span> disabling:1;
00164         <span class="keywordtype">unsigned</span> dma:1;
00165         <span class="keywordtype">unsigned</span> queue_sof:1;
00166 
00167 <span class="preprocessor">#ifdef DWC_EN_ISOC</span>
00168 <span class="preprocessor"></span>
<a name="l00169"></a><a class="code" href="structdwc__otg__pcd__ep.html#o6">00169</a>         <span class="keywordtype">void</span> *iso_req_handle;
00170 <span class="preprocessor">#endif                          //_EN_ISOC_</span>
00171 <span class="preprocessor"></span>
<a name="l00173"></a><a class="code" href="structdwc__otg__pcd__ep.html#o7">00173</a>         <a class="code" href="structdwc__ep.html">dwc_ep_t</a> <a class="code" href="structdwc__ep.html">dwc_ep</a>;
00174 
<a name="l00176"></a><a class="code" href="structdwc__otg__pcd__ep.html#o8">00176</a>         <span class="keyword">struct </span><a class="code" href="structdwc__otg__pcd.html">dwc_otg_pcd</a> *pcd;
00177 
00178         <span class="keywordtype">void</span> *priv;
00179 } <a class="code" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a>;
00180 
<a name="l00184"></a><a class="code" href="structdwc__otg__pcd.html">00184</a> <span class="keyword">struct </span><a class="code" href="structdwc__otg__pcd.html">dwc_otg_pcd</a> {
00185         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structdwc__otg__pcd__function__ops.html">dwc_otg_pcd_function_ops</a> *fops;
<a name="l00187"></a><a class="code" href="structdwc__otg__pcd.html#o1">00187</a>         <span class="keyword">struct </span><a class="code" href="structdwc__otg__device.html">dwc_otg_device</a> *otg_dev;
<a name="l00189"></a><a class="code" href="structdwc__otg__pcd.html#o2">00189</a>         <a class="code" href="structdwc__otg__core__if.html">dwc_otg_core_if_t</a> *core_if;
<a name="l00191"></a><a class="code" href="structdwc__otg__pcd.html#o3">00191</a>         <a class="code" href="dwc__otg__pcd_8h.html#a4">ep0state_e</a> ep0state;
<a name="l00193"></a><a class="code" href="structdwc__otg__pcd.html#o4">00193</a>         <span class="keywordtype">unsigned</span> ep0_pending:1;
<a name="l00195"></a><a class="code" href="structdwc__otg__pcd.html#o5">00195</a>         <span class="keywordtype">unsigned</span> request_config:1;
<a name="l00197"></a><a class="code" href="structdwc__otg__pcd.html#o6">00197</a>         <span class="keywordtype">unsigned</span> remote_wakeup_enable:1;
<a name="l00199"></a><a class="code" href="structdwc__otg__pcd.html#o7">00199</a>         <span class="keywordtype">unsigned</span> b_hnp_enable:1;
<a name="l00201"></a><a class="code" href="structdwc__otg__pcd.html#o8">00201</a>         <span class="keywordtype">unsigned</span> a_hnp_support:1;
<a name="l00203"></a><a class="code" href="structdwc__otg__pcd.html#o9">00203</a>         <span class="keywordtype">unsigned</span> a_alt_hnp_support:1;
<a name="l00205"></a><a class="code" href="structdwc__otg__pcd.html#o10">00205</a>         <span class="keywordtype">unsigned</span> request_pending;
00206 
00211         <span class="keyword">union </span>{
00212                 usb_device_request_t req;
00213                 uint32_t d32[2];
00214         } *setup_pkt;
00215 
00216         dwc_dma_t setup_pkt_dma_handle;
00217 
<a name="l00219"></a><a class="code" href="structdwc__otg__pcd.html#o15">00219</a>         uint16_t *status_buf;
00220         dwc_dma_t status_buf_dma_handle;
00221 
<a name="l00223"></a><a class="code" href="structdwc__otg__pcd.html#o17">00223</a>         <a class="code" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> ep0;
00224 
<a name="l00226"></a><a class="code" href="structdwc__otg__pcd.html#o18">00226</a>         <a class="code" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> in_ep[<a class="code" href="dwc__otg__core__if_8h.html#a3">MAX_EPS_CHANNELS</a> - 1];
<a name="l00228"></a><a class="code" href="structdwc__otg__pcd.html#o19">00228</a>         <a class="code" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> out_ep[<a class="code" href="dwc__otg__core__if_8h.html#a3">MAX_EPS_CHANNELS</a> - 1];
00230 <span class="comment">//        unsigned      num_eps : 4;</span>
<a name="l00231"></a><a class="code" href="structdwc__otg__pcd.html#o20">00231</a>         dwc_spinlock_t *lock;
00232 
<a name="l00236"></a><a class="code" href="structdwc__otg__pcd.html#o21">00236</a>         dwc_tasklet_t *test_mode_tasklet;
00237 
<a name="l00239"></a><a class="code" href="structdwc__otg__pcd.html#o22">00239</a>         dwc_tasklet_t *start_xfer_tasklet;
00240 
<a name="l00242"></a><a class="code" href="structdwc__otg__pcd.html#o23">00242</a>         <span class="keywordtype">unsigned</span> test_mode;
00246 <span class="preprocessor">#ifdef DWC_UTE_CFI</span>
00247 <span class="preprocessor"></span>        <span class="keyword">struct </span>cfiobject *cfi;
00248 <span class="preprocessor">#endif</span>
00249 <span class="preprocessor"></span>
00250 };
00251 
00252 <span class="comment">//FIXME this functions should be static, and this prototypes should be removed</span>
00253 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="dwc__otg__pcd_8h.html#a16">dwc_otg_request_nuke</a>(<a class="code" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> * ep);
00254 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="dwc__otg__pcd_8h.html#a17">dwc_otg_request_done</a>(<a class="code" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> * ep,
00255                                  <a class="code" href="structdwc__otg__pcd__request.html">dwc_otg_pcd_request_t</a> * req, int32_t status);
00256 
00257 <span class="keywordtype">void</span> <a class="code" href="dwc__otg__pcd_8h.html#a18">dwc_otg_iso_buffer_done</a>(<a class="code" href="structdwc__otg__pcd.html">dwc_otg_pcd_t</a> * pcd, <a class="code" href="structdwc__otg__pcd__ep.html">dwc_otg_pcd_ep_t</a> * ep,
00258                              <span class="keywordtype">void</span> *req_handle);
00259 
00260 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="dwc__otg__pcd__intr_8c.html#a31">do_test_mode</a>(<span class="keywordtype">void</span> *data);
00261 <span class="preprocessor">#endif</span>
00262 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* DWC_HOST_ONLY */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Oct 27 03:56:37 2011 for DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
