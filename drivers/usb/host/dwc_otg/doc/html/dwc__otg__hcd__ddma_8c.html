<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver: dwc_otg_hcd_ddma.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>dwc_otg_hcd_ddma.c File Reference</h1>This file contains Descriptor DMA support implementation for host mode. <a href="#_details">More...</a>
<p>
<code>#include "<a class="el" href="dwc__otg__hcd_8h-source.html">dwc_otg_hcd.h</a>"</code><br>
<code>#include "<a class="el" href="dwc__otg__regs_8h-source.html">dwc_otg_regs.h</a>"</code><br>

<p>
<a href="dwc__otg__hcd__ddma_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a0" doxytag="dwc_otg_hcd_ddma.c::ISOC_URB_GIVEBACK_ASAP"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>ISOC_URB_GIVEBACK_ASAP</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a1" doxytag="dwc_otg_hcd_ddma.c::MAX_ISOC_XFER_SIZE_FS"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>MAX_ISOC_XFER_SIZE_FS</b>&nbsp;&nbsp;&nbsp;1023</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a2" doxytag="dwc_otg_hcd_ddma.c::MAX_ISOC_XFER_SIZE_HS"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>MAX_ISOC_XFER_SIZE_HS</b>&nbsp;&nbsp;&nbsp;3072</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a3" doxytag="dwc_otg_hcd_ddma.c::DESCNUM_THRESHOLD"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>DESCNUM_THRESHOLD</b>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a4" doxytag="dwc_otg_hcd_ddma.c::frame_list_idx"></a>
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>frame_list_idx</b> (uint16_t frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a5" doxytag="dwc_otg_hcd_ddma.c::desclist_idx_inc"></a>
uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>desclist_idx_inc</b> (uint16_t idx, uint16_t inc, uint8_t speed)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a6" doxytag="dwc_otg_hcd_ddma.c::desclist_idx_dec"></a>
uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>desclist_idx_dec</b> (uint16_t idx, uint16_t inc, uint8_t speed)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a7" doxytag="dwc_otg_hcd_ddma.c::max_desc_num"></a>
uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>max_desc_num</b> (<a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a8" doxytag="dwc_otg_hcd_ddma.c::frame_incr_val"></a>
uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>frame_incr_val</b> (<a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a9" doxytag="dwc_otg_hcd_ddma.c::desc_list_alloc"></a>
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>desc_list_alloc</b> (<a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a10" doxytag="dwc_otg_hcd_ddma.c::desc_list_free"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>desc_list_free</b> (<a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a11" doxytag="dwc_otg_hcd_ddma.c::frame_list_alloc"></a>
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>frame_list_alloc</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a12" doxytag="dwc_otg_hcd_ddma.c::frame_list_free"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>frame_list_free</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a13" doxytag="dwc_otg_hcd_ddma.c::per_sched_enable"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>per_sched_enable</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, uint16_t fr_list_en)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a14" doxytag="dwc_otg_hcd_ddma.c::per_sched_disable"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>per_sched_disable</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a15" doxytag="dwc_otg_hcd_ddma.c::update_frame_list"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>update_frame_list</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh, uint8_t enable)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a16" doxytag="dwc_otg_hcd_ddma.c::dump_frame_list"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>dump_frame_list</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a17" doxytag="dwc_otg_hcd_ddma.c::release_channel_ddma"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>release_channel_ddma</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__hcd__ddma_8c.html#a18">dwc_otg_hcd_qh_init_ddma</a> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes a QH structure's Descriptor DMA related members.  <a href="#a18"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__hcd__ddma_8c.html#a19">dwc_otg_hcd_qh_free_ddma</a> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Frees descriptor list memory associated with the QH.  <a href="#a19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a20" doxytag="dwc_otg_hcd_ddma.c::frame_to_desc_idx"></a>
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>frame_to_desc_idx</b> (<a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh, uint16_t frame_idx)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a21" doxytag="dwc_otg_hcd_ddma.c::calc_starting_frame"></a>
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>calc_starting_frame</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh, uint8_t *skip_frames)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a22" doxytag="dwc_otg_hcd_ddma.c::recalc_initial_desc_idx"></a>
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>recalc_initial_desc_idx</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a23" doxytag="dwc_otg_hcd_ddma.c::init_isoc_dma_desc"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>init_isoc_dma_desc</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh, uint8_t skip_frames)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a24" doxytag="dwc_otg_hcd_ddma.c::init_non_isoc_dma_desc"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>init_non_isoc_dma_desc</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__hcd__ddma_8c.html#a25">dwc_otg_hcd_start_xfer_ddma</a> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *qh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For Control and Bulk endpoints initializes descriptor list and starts the transfer.  <a href="#a25"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a26" doxytag="dwc_otg_hcd_ddma.c::complete_isoc_xfer_ddma"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>complete_isoc_xfer_ddma</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__hc.html">dwc_hc_t</a> *hc, <a class="el" href="structdwc__otg__hc__regs.html">dwc_otg_hc_regs_t</a> *hc_regs, dwc_otg_halt_status_e halt_status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a27" doxytag="dwc_otg_hcd_ddma.c::update_non_isoc_urb_state_ddma"></a>
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>update_non_isoc_urb_state_ddma</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__hc.html">dwc_hc_t</a> *hc, <a class="el" href="structdwc__otg__qtd.html">dwc_otg_qtd_t</a> *qtd, <a class="el" href="structdwc__otg__host__dma__desc.html">dwc_otg_host_dma_desc_t</a> *dma_desc, dwc_otg_halt_status_e halt_status, uint32_t n_bytes, uint8_t *xfer_done)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a28" doxytag="dwc_otg_hcd_ddma.c::complete_non_isoc_xfer_ddma"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>complete_non_isoc_xfer_ddma</b> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__hc.html">dwc_hc_t</a> *hc, <a class="el" href="structdwc__otg__hc__regs.html">dwc_otg_hc_regs_t</a> *hc_regs, dwc_otg_halt_status_e halt_status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dwc__otg__hcd__ddma_8c.html#a29">dwc_otg_hcd_complete_xfer_ddma</a> (<a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *hcd, <a class="el" href="structdwc__hc.html">dwc_hc_t</a> *hc, <a class="el" href="structdwc__otg__hc__regs.html">dwc_otg_hc_regs_t</a> *hc_regs, dwc_otg_halt_status_e halt_status)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is called from interrupt handlers.  <a href="#a29"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This file contains Descriptor DMA support implementation for host mode. 
<p>

<p>
Definition in file <a class="el" href="dwc__otg__hcd__ddma_8c-source.html">dwc_otg_hcd_ddma.c</a>.<hr><h2>Function Documentation</h2>
<a class="anchor" name="a18" doxytag="dwc_otg_hcd_ddma.c::dwc_otg_hcd_qh_init_ddma"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int dwc_otg_hcd_qh_init_ddma           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>hcd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>qh</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initializes a QH structure's Descriptor DMA related members. 
<p>
Allocates memory for descriptor list. On first periodic QH, allocates memory for FrameList and enables periodic scheduling.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hcd</em>&nbsp;</td><td>The HCD state structure for the DWC OTG controller. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qh</em>&nbsp;</td><td>The QH to init.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 if successful, negative error code otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="dwc__otg__hcd__ddma_8c-source.html#l00312">312</a> of file <a class="el" href="dwc__otg__hcd__ddma_8c-source.html">dwc_otg_hcd_ddma.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="dwc_otg_hcd_ddma.c::dwc_otg_hcd_qh_free_ddma"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void dwc_otg_hcd_qh_free_ddma           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>hcd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>qh</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Frees descriptor list memory associated with the QH. 
<p>
If QH is periodic and the last, frees FrameList memory and disables periodic scheduling.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hcd</em>&nbsp;</td><td>The HCD state structure for the DWC OTG controller. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qh</em>&nbsp;</td><td>The QH to init. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="dwc__otg__hcd__ddma_8c-source.html#l00346">346</a> of file <a class="el" href="dwc__otg__hcd__ddma_8c-source.html">dwc_otg_hcd_ddma.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="dwc_otg_hcd_ddma.c::dwc_otg_hcd_start_xfer_ddma"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void dwc_otg_hcd_start_xfer_ddma           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>hcd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structdwc__otg__qh.html">dwc_otg_qh_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>qh</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
For Control and Bulk endpoints initializes descriptor list and starts the transfer. 
<p>
For Interrupt and Isochronous endpoints initializes descriptor list then updates FrameList, marking appropriate entries as active. In case of Isochronous, the starting descriptor index is calculated based on the scheduled frame, but only on the first transfer descriptor within a session. Then starts the transfer via enabling the channel. For Isochronous endpoint the channel is not halted on XferComplete interrupt so remains assigned to the endpoint(QH) until session is done.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hcd</em>&nbsp;</td><td>The HCD state structure for the DWC OTG controller. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qh</em>&nbsp;</td><td>The QH to init.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 if successful, negative error code otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="dwc__otg__hcd__ddma_8c-source.html#l00702">702</a> of file <a class="el" href="dwc__otg__hcd__ddma_8c-source.html">dwc_otg_hcd_ddma.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="dwc_otg_hcd_ddma.c::dwc_otg_hcd_complete_xfer_ddma"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void dwc_otg_hcd_complete_xfer_ddma           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structdwc__otg__hcd.html">dwc_otg_hcd_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>hcd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structdwc__hc.html">dwc_hc_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>hc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structdwc__otg__hc__regs.html">dwc_otg_hc_regs_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>hc_regs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>dwc_otg_halt_status_e&nbsp;</td>
          <td class="mdname" nowrap> <em>halt_status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is called from interrupt handlers. 
<p>
Scans the descriptor list, updates URB's status and calls completion routine for the URB if it's done. Releases the channel to be used by other transfers. In case of Isochronous endpoint the channel is not halted until the end of the session, i.e. QTD list is empty. If periodic channel released the FrameList is updated accordingly.<p>
Calls transaction selection routines to activate pending transfers.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hcd</em>&nbsp;</td><td>The HCD state structure for the DWC OTG controller. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hc</em>&nbsp;</td><td>Host channel, the transfer is completed on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hc_regs</em>&nbsp;</td><td>Host channel registers. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>halt_status</em>&nbsp;</td><td>Reason the channel is being halted, or just XferComplete for isochronous transfer</td></tr>
  </table>
</dl>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>Consider the case when period exceeds FrameList size. Frame Rollover interrupt should be used. </dd></dl>

<p>
Definition at line <a class="el" href="dwc__otg__hcd__ddma_8c-source.html#l01062">1062</a> of file <a class="el" href="dwc__otg__hcd__ddma_8c-source.html">dwc_otg_hcd_ddma.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 27 03:56:38 2011 for DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
